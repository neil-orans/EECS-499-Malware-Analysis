#!/usr/bin/python

import sys

# REQUIRES: 'replacement' is new bytes
# 			'bytes' is the entire byte stream (whole file)
#			'position' is location of original
def patch(replacement, bytes, position):
	first_part = bytes[:position]
	second_part = replacement + bytes[(position+len(replacement)):]
	return first_part + second_part

original = bytearray(b'\x50\x00\x6C\x00\x65\x00\x61\x00\x73\x00\x65\x00\x20\x00\x69\x00\x6E\x00\x73\x00\x65\x00\x72\x00\x74\x00\x20')

replacement = bytearray(b'\x57\x00\x65\x00\x6C\x00\x63\x00\x6F\x00\x6D\x00\x65\x00\x21\x00\x00\x00\x73\x00\x65\x00\x72\x00\x74\x00\x20\x00\x43\x00\x44\x00\x2E\x00\x2E\x00\x2E\x00\x00\x00\x00\x00\x00\x54\x00\x68\x00\x69\x00\x73\x00\x20\x00\x69\x00\x73\x00\x20\x00\x61\x00\x20\x00\x70\x00\x61\x00\x74\x00\x63\x00\x68\x00\x65\x00\x64\x00\x20\x00\x76\x00\x65\x00\x72\x00\x73\x00\x69\x00\x6F\x00\x6E\x00\x20\x00\x6F\x00\x66\x00\x20\x00\x46\x00\x72\x00\x65\x00\x65\x00\x63\x00\x65\x00\x6C\x00\x6C\x00\x21\x00\x00\x00\x68\x00\x65\x00\x20\x00\x67\x00\x61\x00\x6D\x00\x65\x00\x21\x00\x00\x00\x00\x00\x00\x6A\x40\x68\x7D\x61\x00\x01\x68\xA8\x61\x00\x01\x6A\x00\xFF\x15\x14\x11\x00\x01\x6A\x00\x90\x90\x90\x90\x90\x90')

bytes = 0
with open(sys.argv[1], "rb") as cd_check_exe:
	bytes = bytearray(cd_check_exe.read())
	bytes = patch(replacement, bytes, bytes.find(original))

with open("patched_cd_check.exe", "wb") as output_exe:
	output_exe.write(bytes)